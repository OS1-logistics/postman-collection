{
	"info": {
		"_postman_id": "f36ec643-431a-4cfb-be39-57174cc36243",
		"name": "Geofence UAT",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "25995643",
		"_collection_link": "https://dark-satellite-592830.postman.co/workspace/My-Workspace~877911b8-d08d-49e8-88ab-901b2b383645/collection/25995643-f36ec643-431a-4cfb-be39-57174cc36243?action=share&source=collection_link&creator=25995643"
	},
	"item": [
		{
			"name": "Token",
			"item": [
				{
					"name": "Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"var accessToken = jsonData.data.accessToken;",
									"",
									"pm.environment.set(\"token\", accessToken);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-COREOS-REQUEST-ID",
								"value": "{{request_id}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "X-COREOS-TID",
								"value": "{{tenant_id}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"clientId\":\"{{client_id}}\",\n    \"clientSecret\":\"{{client_secret}}\",\n  \"audience\": \"platform:app:coreos\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/core/api/v1/aaa/auth/client-credentials",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"core",
								"api",
								"v1",
								"aaa",
								"auth",
								"client-credentials"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Geofence API Flow",
			"item": [
				{
					"name": "Creates Geofence",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"var geofenceId = jsonData.data.geofenceId;",
									"",
									"pm.environment.set(\"geofenceId\", geofenceId);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"description": "(Required) Tenant ID.",
								"key": "X-COREOS-TID",
								"value": "{{tenant_id}}"
							},
							{
								"description": "(Required) Core-os access token.",
								"key": "X-COREOS-ACCESS",
								"value": "{{token}}"
							},
							{
								"description": "(Required) Unique RequestId.",
								"key": "X-COREOS-REQUEST-ID",
								"value": "{{request_id}}"
							},
							{
								"description": "Core-os user info.",
								"key": "X-COREOS-USERINFO",
								"value": "<string>"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"TestGeofence1\",\n    \"geojson\": {\n        \"type\": \"FeatureCollection\",\n        \"features\": [\n            {\n                \"type\": \"Feature\",\n                \"properties\": {\n                    \"description\": \"Geofence for Store XYZ\",\n                    \"radius\": 1000\n                },\n                \"geometry\": {\n                    \"coordinates\": [\n                        77.21875869283741,\n                        28.632319404674092\n                    ],\n                    \"type\": \"Point\"\n                }\n            }\n        ]\n    }\n}",
							"options": {
								"raw": {
									"headerFamily": "json",
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/core/api/v1/mts-geofences/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"core",
								"api",
								"v1",
								"mts-geofences",
								""
							]
						},
						"description": "This endpoint is used to create a new geofence entry in the database for which the notification is to be sent when the GPS device approaches the location."
					},
					"response": []
				},
				{
					"name": "Get Geofence",
					"request": {
						"method": "GET",
						"header": [
							{
								"description": "(Required) Tenant ID.",
								"key": "X-COREOS-TID",
								"value": "{{tenant_id}}"
							},
							{
								"description": "(Required) Core-os access token.",
								"key": "X-COREOS-ACCESS",
								"value": "{{token}}"
							},
							{
								"description": "(Required) Unique RequestId.",
								"key": "X-COREOS-REQUEST-ID",
								"value": "{{request_id}}"
							},
							{
								"description": "Core-os user info.",
								"key": "X-COREOS-USERINFO",
								"value": "<string>"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/core/api/v1/mts-geofences/{{geofenceId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"core",
								"api",
								"v1",
								"mts-geofences",
								"{{geofenceId}}"
							]
						},
						"description": "This endpoint is used to get a specific geofence (using a geofenceId).\n"
					},
					"response": []
				},
				{
					"name": "Subscribe Device(s) to a GeofenceId",
					"request": {
						"method": "PUT",
						"header": [
							{
								"description": "(Required) Tenant ID.",
								"key": "X-COREOS-TID",
								"value": "{{tenant_id}}"
							},
							{
								"description": "(Required) Core-os access token.",
								"key": "X-COREOS-ACCESS",
								"value": "{{token}}"
							},
							{
								"description": "(Required) Unique RequestId.",
								"key": "X-COREOS-REQUEST-ID",
								"value": "{{request_id}}"
							},
							{
								"description": "Core-os user info.",
								"key": "X-COREOS-USERINFO",
								"value": "<string>"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"deviceId\": [\n    \"<string>\",\n    \"<string>\"\n  ],\n  \"callback\": {\n    \"url\": \"https://example.webhook.site\",\n    \"meta\": {}\n  },\n  \"expiry\": \"1d4h3m\",\n  \"geofenceType\": \"both\"\n}",
							"options": {
								"raw": {
									"headerFamily": "json",
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/core/api/v1/mts-geofences/{{geofenceId}}/devices",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"core",
								"api",
								"v1",
								"mts-geofences",
								"{{geofenceId}}",
								"devices"
							],
							"query": [
								{
									"key": "nextPage",
									"value": "<string>",
									"disabled": true
								}
							]
						},
						"description": "This endpoint is used to subsceibe device(s) to a particular geofenceId. User can use the same API to override the details if they wish to update them for a specific geofenceId and deviceId."
					},
					"response": []
				},
				{
					"name": "Get Devices Subscribed to GeofenceId",
					"request": {
						"method": "GET",
						"header": [
							{
								"description": "(Required) Tenant ID.",
								"key": "X-COREOS-TID",
								"value": "{{tenant_id}}"
							},
							{
								"description": "(Required) Core-os access token.",
								"key": "X-COREOS-ACCESS",
								"value": "{{token}}"
							},
							{
								"description": "(Required) Unique RequestId.",
								"key": "X-COREOS-REQUEST-ID",
								"value": "{{request_id}}"
							},
							{
								"description": "Core-os user info.",
								"key": "X-COREOS-USERINFO",
								"value": "<string>"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/core/api/v1/mts-geofences/{{geofenceId}}/devices",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"core",
								"api",
								"v1",
								"mts-geofences",
								"{{geofenceId}}",
								"devices"
							],
							"query": [
								{
									"key": "nextPage",
									"value": "<string>",
									"description": "scrollId that returns the values for next page of results. This link expires in 60 minutes",
									"disabled": true
								}
							]
						},
						"description": "This endpoint is used to fetch all devices subscribed to a geofenceId"
					},
					"response": []
				},
				{
					"name": "Send Trace Info",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "X-COREOS-ACCESS",
								"value": "{{token}}",
								"type": "text"
							},
							{
								"key": "X-COREOS-REQUEST-ID",
								"value": "{{request_id}}",
								"type": "text"
							},
							{
								"key": "X-COREOS-TID",
								"value": "{{tenant_id}}",
								"type": "text"
							},
							{
								"key": "X-COREOS-USERINFO",
								"value": "{{user_info}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[\n    {\n        \"tis\": 1636108615000,\n        \"kafkaArrivalTis\": 1628088415000,\n        \"lat\": 11.456,\n        \"lon\": 72.456,\n        \"seq\": 2,\n        \"id\": [\n            \"dispatch-1\",\n            \"dispatch-2\"\n        ],\n        \"speed\": 0.06\n    },\n    {\n        \"tis\": 1636108616000,\n        \"kafkaArrivalTis\": 1628088425000,\n        \"lat\": 11.456,\n        \"lon\": 72.456,\n        \"seq\": 2,\n        \"accuracy\": 20,\n        \"evt\": {\n            \"name\": \"string\",\n            \"data\": {}\n        },\n        \"id\": [\n            \"dispatch-1\",\n            \"dispatch-2\"\n        ],\n        \"speed\": 0.06\n    }\n]"
						},
						"url": {
							"raw": "{{baseUrl}}/core/api/v1/mts/devices/{{deviceId}}/apps/{{appId}}/trace",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"core",
								"api",
								"v1",
								"mts",
								"devices",
								"{{deviceId}}",
								"apps",
								"{{appId}}",
								"trace"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}